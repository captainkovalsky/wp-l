{"version":3,"names":["STATE_INCLUDED_COUNTRIES","POSTAL_CODE_EXCLUDED_COUNTRIES","CITY_EXCLUDED_COUNTRIES","hasPostal","countryCode","includes","hasCity","hasState","lang","_a","window","scData","locale","navigator","language","browserLanguage","languages","countryChoices","async","url","addQueryArgs","response","fetch","data","json","map","code","name","value","label","getCountryDetails","isAddressComplete","address","country","line_1","postal_code","city","state"],"sources":["src/functions/address.ts"],"sourcesContent":["import { __ } from '@wordpress/i18n';\nimport { addQueryArgs } from '@wordpress/url';\nimport { Address } from '../types';\nexport const STATE_INCLUDED_COUNTRIES = ['AU', 'BR', 'CA', 'CH', 'ES', 'HK', 'IE', 'IN', 'IT', 'JP', 'MY', 'MX', 'US'];\nexport const POSTAL_CODE_EXCLUDED_COUNTRIES = ['HK'];\nexport const CITY_EXCLUDED_COUNTRIES = ['SG'];\nimport countries from './countries.json';\n\nexport const hasPostal = (countryCode: string) => {\n  return !POSTAL_CODE_EXCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasCity = (countryCode: string) => {\n  return !CITY_EXCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasState = (countryCode: string) => {\n  return STATE_INCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasCompleteAddress = args => {\n  const { country, state } = args;\n  // does it have the fields filled out?\n  if (!hasRequiredFields(args)) {\n    return false;\n  }\n  return hasState(country) ? hasCorrectState(country, state) : true;\n};\n\nexport const hasCorrectState = (country, state) => {\n  return (countries?.[country] || ([] as Array<{ value: string; label: string }>)).some(({ value }) => value === state);\n};\n\nexport const hasRequiredFields = ({ city, country, line_1, postal_code, state }) => {\n  if (!country) {\n    return false;\n  }\n  if (hasPostal(country) && !postal_code) {\n    return false;\n  }\n  if (hasCity(country) && !city) {\n    return false;\n  }\n  if (hasState(country) && !state) {\n    return false;\n  }\n  return !!line_1;\n};\n\nconst lang = window.scData?.locale || navigator.language || (navigator as any)?.browserLanguage || (navigator.languages || ['en'])[0];\n\nexport const countryChoices = async () => {\n  const url = addQueryArgs(`https://api.surecart.com/v1/public/atlas`, {\n    locale: lang,\n  });\n  const response = await fetch(url);\n  const data: any = await response.json();\n  return data?.data.map(({ code, name }) => ({ value: code, label: name })) as Array<{ value: string; label: string }>;\n};\n\nexport const getCountryDetails = async (countryCode: string) => {\n  const url = addQueryArgs(`https://api.surecart.com/v1/public/atlas/${countryCode}`, {\n    locale: lang,\n  });\n  const response = await fetch(url);\n  return await response.json();\n};\n\nexport const isAddressComplete = (address: Partial<Address>) => {\n  return (\n    address?.country && // must have country\n    address?.line_1 && // must have line 1\n    (hasPostal(address.country) ? address?.postal_code : true) && // should have postal code if applicable\n    (hasCity(address.country) ? address?.city : true) && // should have city if applicable\n    (hasState(address.country) ? address?.state : true) // should have state if applicable\n  );\n};\n\nexport const isAddressCompleteEnough = (address: Partial<Address>) => {\n  return (\n    address?.country && // must have country\n    (hasPostal(address.country) ? address?.postal_code : true) && // should have postal code if applicable\n    (hasCity(address.country) ? address?.city : true) && // should have city if applicable\n    (hasState(address.country) ? address?.state : true) // should have state if applicable\n  );\n};\n"],"mappings":"0CAGO,MAAMA,EAA2B,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1G,MAAMC,EAAiC,CAAC,MACxC,MAAMC,EAA0B,CAAC,MAGjC,MAAMC,EAAaC,IAChBH,EAA+BI,SAASD,GAG3C,MAAME,EAAWF,IACdF,EAAwBG,SAASD,GAGpC,MAAMG,EAAYH,GAChBJ,EAAyBK,SAASD,GAgC3C,MAAMI,IAAOC,EAAAC,OAAOC,UAAM,MAAAF,SAAA,SAAAA,EAAEG,SAAUC,UAAUC,WAAaD,YAAiB,MAAjBA,iBAAS,SAATA,UAAmBE,mBAAoBF,UAAUG,WAAa,CAAC,OAAO,G,MAEtHC,EAAiBC,UAC5B,MAAMC,EAAMC,EAAa,2CAA4C,CACnER,OAAQJ,IAEV,MAAMa,QAAiBC,MAAMH,GAC7B,MAAMI,QAAkBF,EAASG,OACjC,OAAOD,IAAI,MAAJA,SAAI,SAAJA,EAAMA,KAAKE,KAAI,EAAGC,OAAMC,WAAM,CAAQC,MAAOF,EAAMG,MAAOF,KAAmD,E,MAGzGG,EAAoBZ,MAAOd,IACtC,MAAMe,EAAMC,EAAa,4CAA4ChB,IAAe,CAClFQ,OAAQJ,IAEV,MAAMa,QAAiBC,MAAMH,GAC7B,aAAaE,EAASG,MAAM,E,MAGjBO,EAAqBC,IAE9BA,IAAO,MAAPA,SAAO,SAAPA,EAASC,WACTD,IAAO,MAAPA,SAAO,SAAPA,EAASE,UACR/B,EAAU6B,EAAQC,SAAWD,IAAO,MAAPA,SAAO,SAAPA,EAASG,YAAc,QACpD7B,EAAQ0B,EAAQC,SAAWD,IAAO,MAAPA,SAAO,SAAPA,EAASI,KAAO,QAC3C7B,EAASyB,EAAQC,SAAWD,IAAO,MAAPA,SAAO,SAAPA,EAASK,MAAQ,a","ignoreList":[]}