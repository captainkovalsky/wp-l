{"version":3,"file":"address.js","sourceRoot":"","sources":["../../src/functions/address.ts"],"names":[],"mappings":"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","sourcesContent":["import { __ } from '@wordpress/i18n';\nimport { addQueryArgs } from '@wordpress/url';\nimport { Address } from '../types';\nexport const STATE_INCLUDED_COUNTRIES = ['AU', 'BR', 'CA', 'CH', 'ES', 'HK', 'IE', 'IN', 'IT', 'JP', 'MY', 'MX', 'US'];\nexport const POSTAL_CODE_EXCLUDED_COUNTRIES = ['HK'];\nexport const CITY_EXCLUDED_COUNTRIES = ['SG'];\nimport countries from './countries.json';\n\nexport const hasPostal = (countryCode: string) => {\n  return !POSTAL_CODE_EXCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasCity = (countryCode: string) => {\n  return !CITY_EXCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasState = (countryCode: string) => {\n  return STATE_INCLUDED_COUNTRIES.includes(countryCode);\n};\n\nexport const hasCompleteAddress = args => {\n  const { country, state } = args;\n  // does it have the fields filled out?\n  if (!hasRequiredFields(args)) {\n    return false;\n  }\n  return hasState(country) ? hasCorrectState(country, state) : true;\n};\n\nexport const hasCorrectState = (country, state) => {\n  return (countries?.[country] || ([] as Array<{ value: string; label: string }>)).some(({ value }) => value === state);\n};\n\nexport const hasRequiredFields = ({ city, country, line_1, postal_code, state }) => {\n  if (!country) {\n    return false;\n  }\n  if (hasPostal(country) && !postal_code) {\n    return false;\n  }\n  if (hasCity(country) && !city) {\n    return false;\n  }\n  if (hasState(country) && !state) {\n    return false;\n  }\n  return !!line_1;\n};\n\nconst lang = window.scData?.locale || navigator.language || (navigator as any)?.browserLanguage || (navigator.languages || ['en'])[0];\n\nexport const countryChoices = async () => {\n  const url = addQueryArgs(`https://api.surecart.com/v1/public/atlas`, {\n    locale: lang,\n  });\n  const response = await fetch(url);\n  const data: any = await response.json();\n  return data?.data.map(({ code, name }) => ({ value: code, label: name })) as Array<{ value: string; label: string }>;\n};\n\nexport const getCountryDetails = async (countryCode: string) => {\n  const url = addQueryArgs(`https://api.surecart.com/v1/public/atlas/${countryCode}`, {\n    locale: lang,\n  });\n  const response = await fetch(url);\n  return await response.json();\n};\n\nexport const isAddressComplete = (address: Partial<Address>) => {\n  return (\n    address?.country && // must have country\n    address?.line_1 && // must have line 1\n    (hasPostal(address.country) ? address?.postal_code : true) && // should have postal code if applicable\n    (hasCity(address.country) ? address?.city : true) && // should have city if applicable\n    (hasState(address.country) ? address?.state : true) // should have state if applicable\n  );\n};\n\nexport const isAddressCompleteEnough = (address: Partial<Address>) => {\n  return (\n    address?.country && // must have country\n    (hasPostal(address.country) ? address?.postal_code : true) && // should have postal code if applicable\n    (hasCity(address.country) ? address?.city : true) && // should have city if applicable\n    (hasState(address.country) ? address?.state : true) // should have state if applicable\n  );\n};\n"]}